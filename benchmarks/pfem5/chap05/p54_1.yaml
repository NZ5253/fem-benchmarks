id: pfem5_ch05_p54_p54_1
title: "PFEM Program 5.4 (p54) — Axisymmetric strain of elastic solid — case p54_1"

purpose: >
  Axisymmetric strain analysis of elastic solids using triangular or quadrilateral isoparametric
  elements. This benchmark uses 9-node quadrilateral elements in an axisymmetric formulation.

authors:
  source:
    book: "Programming the Finite Element Method"
    edition: "5th"
    chapter: 5
    program: "p54"
    dataset: "p54_1"
  entry:
    created_by: "Naeem"
    created_on: "2026-01-09"
    verified_platform: "Linux (gfortran)"

code:
  language: "Fortran (F2003)"
  source_file: "source/chap05/p54.f03"
  uses_modules: ["main", "geom"]
  io_reads_from_unit10:
    - {line: 24, stmt: "READ(10,*)element,nod,nels,nn,nip,nodof,nst,ndim,np_types"}
    - {line: 31, stmt: "READ(10,*)prop"}
    - {line: 33, stmt: "IF(np_types>1)READ(10,*)etype"}
    - {line: 34, stmt: "READ(10,*)g_coord"}
    - {line: 35, stmt: "READ(10,*)g_num"}
    - {line: 38, stmt: "READ(10,*)nr,(k,nf(:,k),i=1,nr)"}
    - {line: 82, stmt: "READ(10,*)loaded_nodes,(k,loads(nf(:,k)),i=1,loaded_nodes)"}
    - {line: 84, stmt: "READ(10,*)fixed_freedoms"}
    - {line: 88, stmt: "READ(10,*)(node(i),sense(i),value(i),i=1,fixed_freedoms)"}

fem:
  dimension: 2
  formulation:
    code_supports: ["axisymmetric"]
    this_case: "axisymmetric"
  dof:
    per_node: 2
    names: ["r-disp", "z-disp"]
    dof_indexing: {1: "r-disp", 2: "z-disp"}
  element:
    family: "quadrilateral"
    nodes_per_element: 9
    supported:
      triangles_nodes: [3, 6, 10, 15]
      quads_nodes: [4, 8, 9]

analysis:
  physics: "linear elasticity"
  type: "linear"
  regime: "steady-state"

units:
  system: "consistent"
  notes: >
    PFEM assumes consistent units (not enforced). Pick a unit system and keep geometry,
    E, and loads consistent.

tunable_parameters:
  - name: youngs_modulus_E
    path: "inputs.record2.material.E.value"
    type: "real"
    unit_category: "stress"
    notes: "Material stiffness. Very common sweep parameter."
    suggested_range: [1.0e4, 1.0e9]

  - name: poisson_ratio_nu
    path: "inputs.record2.material.nu.value"
    type: "real"
    unit_category: "dimensionless"
    notes: "Material parameter, often kept fixed unless studying sensitivity."
    suggested_range: [0.0, 0.49]

  - name: nodal_loads_values
    path: "inputs.record7.nodal_loads[*].(load_dof1,load_dof2)"
    type: "real"
    unit_category: "force"
    notes: "Applied nodal forces."

  - name: mesh_resolution
    path: "inputs.record1.(nels,nn)"
    type: "int"
    unit_category: "-"
    notes: >
      Structural knob: changes mesh resolution through number of elements and nodes.

input_schema:
  file_type: ".dat"
  reads_in_order:
    - record: 1
      fortran_read: "READ(10,*)element,nod,nels,nn,nip,nodof,nst,ndim,np_types"
      fields:
        - {name: element, type: string, allowed: ["triangle", "quadrilateral", "tetrahedron", "hexahedron"]}
        - {name: nod, type: int, description: "Nodes per element"}
        - {name: nels, type: int, description: "Number of elements"}
        - {name: nn, type: int, description: "Number of nodes"}
        - {name: nip, type: int, description: "Number of integration points"}
        - {name: nodof, type: int, description: "Degrees of freedom per node"}
        - {name: nst, type: int, description: "Number of stress terms"}
        - {name: ndim, type: int, description: "Number of dimensions"}
        - {name: np_types, type: int, description: "Number of property types"}

    - record: 2
      fortran_read: "READ(10,*)prop"
      fields:
        - name: prop
          type: "real_matrix"
          shape: "(nprops=3, np_types)"
          description: "[E, nu, rho] per material type (rho often 0.0)"

    - record: 3
      fortran_read: "IF(np_types>1)READ(10,*)etype"
      condition: "only if np_types > 1"
      fields:
        - {name: etype, type: "int_array", shape: "(nels)", description: "Element type array"}

    - record: 4
      fortran_read: "READ(10,*)g_coord"
      fields:
        - name: g_coord
          type: "real_matrix"
          shape: "(ndim, nn)"
          description: "Global nodal coordinates [r, z]"

    - record: 5
      fortran_read: "READ(10,*)g_num"
      fields:
        - name: g_num
          type: "int_matrix"
          shape: "(nod, nels)"
          description: "Element connectivity table"

    - record: 6
      fortran_read: "READ(10,*)nr,(k,nf(:,k),i=1,nr)"
      fields:
        - {name: nr, type: int}
        - name: bc_table
          type: "table"
          columns:
            - {name: node, type: int}
            - {name: nf_flag_dof1, type: int, allowed: [0, 1]}
            - {name: nf_flag_dof2, type: int, allowed: [0, 1]}
          notes: "Typically 0=fixed, 1=free before numbering by formnf()."

    - record: 7
      fortran_read: "READ(10,*)loaded_nodes,(k,loads(nf(:,k)),i=1,loaded_nodes)"
      fields:
        - {name: loaded_nodes, type: int}
        - name: nodal_loads
          type: "table"
          columns:
            - {name: node, type: int}
            - {name: load_dof1, type: real}
            - {name: load_dof2, type: real}

    - record: 8
      fortran_read: "READ(10,*)fixed_freedoms"
      fields:
        - {name: fixed_freedoms, type: int}

    - record: 9
      fortran_read: "READ(10,*)(node(i),sense(i),value(i),i=1,fixed_freedoms)"
      condition: "only if fixed_freedoms > 0"
      fields:
        - name: prescribed_displacements
          type: "table"
          columns:
            - {name: node, type: int}
            - {name: sense_dof, type: int, allowed: [1, 2]}
            - {name: value, type: real}

inputs:
  working_directory: "executable/chap05"
  basename: "p54_1"
  dat_file: "executable/chap05/p54_1.dat"

  record1:
    element: "quadrilateral"
    nod: 9
    nels: 6
    nn: 35
    nip: 9
    nodof: 2
    nst: 3
    ndim: 2
    np_types: 1

  record2:
    material:
      E: {value: 1.0e6, unit_category: "stress"}
      nu: {value: 0.3, unit_category: "dimensionless"}
      rho: {value: 0.0, unit_category: "density"}

  record3:
    etype: []

  record4:
    g_coord:
      r_coords: [0.0, 1.5, 3.0, 4.5, 6.0, 0.0, 1.5, 3.0, 4.5, 6.0, 0.0, 1.5, 3.0, 4.5, 6.0, 0.0, 1.5, 3.0, 4.5, 6.0, 0.0, 1.5, 3.0, 4.5, 6.0, 0.0, 1.5, 3.0, 4.5, 6.0, 0.0, 1.5, 3.0, 4.5, 6.0]
      z_coords: [0.0, 0.0, 0.0, 0.0, 0.0, -1.5, -1.5, -1.5, -1.5, -1.5, -3.0, -3.0, -3.0, -3.0, -3.0, -4.5, -4.5, -4.5, -4.5, -4.5, -6.0, -6.0, -6.0, -6.0, -6.0, -7.5, -7.5, -7.5, -7.5, -7.5, -9.0, -9.0, -9.0, -9.0, -9.0]
      unit_category: "length"

  record5:
    g_num:
      - [11, 6, 1, 2, 3, 8, 13, 12, 7]
      - [21, 16, 11, 12, 13, 18, 23, 22, 17]
      - [31, 26, 21, 22, 23, 28, 33, 32, 27]
      - [13, 8, 3, 4, 5, 10, 15, 14, 9]
      - [23, 18, 13, 14, 15, 20, 25, 24, 19]
      - [33, 28, 23, 24, 25, 30, 35, 34, 29]

  record6:
    nr: 17
    bc_table:
      - {node: 1, nf_flag_dof1: 0, nf_flag_dof2: 1}
      - {node: 5, nf_flag_dof1: 0, nf_flag_dof2: 1}
      - {node: 6, nf_flag_dof1: 0, nf_flag_dof2: 1}
      - {node: 10, nf_flag_dof1: 0, nf_flag_dof2: 1}
      - {node: 11, nf_flag_dof1: 0, nf_flag_dof2: 1}
      - {node: 15, nf_flag_dof1: 0, nf_flag_dof2: 1}
      - {node: 16, nf_flag_dof1: 0, nf_flag_dof2: 1}
      - {node: 20, nf_flag_dof1: 0, nf_flag_dof2: 1}
      - {node: 21, nf_flag_dof1: 0, nf_flag_dof2: 1}
      - {node: 25, nf_flag_dof1: 0, nf_flag_dof2: 1}
      - {node: 26, nf_flag_dof1: 0, nf_flag_dof2: 1}
      - {node: 30, nf_flag_dof1: 0, nf_flag_dof2: 1}
      - {node: 31, nf_flag_dof1: 0, nf_flag_dof2: 0}
      - {node: 32, nf_flag_dof1: 0, nf_flag_dof2: 0}
      - {node: 33, nf_flag_dof1: 0, nf_flag_dof2: 0}
      - {node: 34, nf_flag_dof1: 0, nf_flag_dof2: 0}
      - {node: 35, nf_flag_dof1: 0, nf_flag_dof2: 0}

  record7:
    loaded_nodes: 3
    nodal_loads:
      - {node: 1, load_dof1: 0.0, load_dof2: -0.5}
      - {node: 2, load_dof1: 0.0, load_dof2: -2.0}
      - {node: 3, load_dof1: 0.0, load_dof2: -0.5}

  record8:
    fixed_freedoms: 0

  record9:
    prescribed_displacements: []

outputs:
  output_directory: "executable/chap05"
  files_created_confirmed:
    - "p54_1.res"
    - "p54_1.msh"
    - "p54_1.vec"
    - "p54_1.dis"

how_to_run:
  linux:
    - "cd ~/Downloads/pfem5/5th_ed/executable/chap05"
    - 'printf "p54_1\n" | ~/Downloads/pfem5/5th_ed/build/bin/p54'
  matlab:
    - "pfem_root = '~/Downloads/pfem5/5th_ed';"
    - "[status, outputs] = pfem_runner(pfem_root, 'chap05', 'p54', 'p54_1');"

notes:
  - "Program prompts for the base name of the .dat file (do not type the .dat extension)."
  - "For parametric studies in MATLAB, use the paths in tunable_parameters to modify specific values."
